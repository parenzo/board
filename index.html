<html>
<head>
<title>Crux Soundboard</title>
<body onload="createMainBoard()">
<style>

h2 {
	font-family: "Verdana", Geneva, sans-serif;
}

h3 {
	font-family: "Verdana", Geneva, sans-serif;
}

.grid-header {
   display: inline-grid;
   grid-gap: 10px 10px;
   grid-template-columns: 17% 18% 18% 18% 18%;
   width: 100vw;  
}

.grid-container {
   display: inline-grid;
   grid-gap: 10px 10px;
   grid-template-columns: 30% 30% 30%; 
   width: 100vw;  
}

button {	
   	font-size: 20pt;
   	font-family: "Verdana", Geneva, sans-serif;
	min-height: 60px;
}

.playingButton {
	background: linear-gradient(to right, rgb(52, 235, 146) 100%, white 0%);
}

.jingleButton {
	background-color: white; 
	border: 2px solid #008CBA;
}

.cruxButton {
	border: 2px solid black;
}

.btnStop {
   	color: rgb(245, 66, 114);
	grid-row-gap: 1ch;
}

.btnAll {
   	color: rgb(66, 194, 245);
	grid-row-gap: 1ch;
}

</style>
<script>

	class Sound {
		constructor(resource, description, tags) {			
			this.resource = resource;
			this.description = description;
			this.tags = tags;
		}		
	}

	function stopAudio(sound, audio, button)
	{
		audio.pause();
		audio.currentTime = 0;
		button.className = ButtonClass(sound);
	}
	
	function playAudio(sound, audio, button)
	{
		audio.play();
		button.className = "playingButton";	
	}

	function MakeAudioElementId(sound) {
		return "audio_" + sound.resource;
	}

	function MakeButtonElementId(sound) {
		return "btn_" + sound.resource;
	}

	function MakeAudioElement(sound) {
		var audioElement = document.createElement('audio');		
		var id = MakeAudioElementId(sound);		
		audioElement.setAttribute('id', id);
		audioElement.setAttribute('src', sound.resource);
		audioElement.setAttribute('class', 'grid-item');	
		document.body.appendChild(audioElement);
		return audioElement;
	}

	function ButtonClass(sound) {
		if (sound.tags.includes("jingle")){		
			return "jingleButton";
		}
		return "cruxButton";
	}

	function MakeButtonElement(sound) {
		var buttonElement = document.createElement('button');	
		buttonElement.setAttribute('id', MakeButtonElementId(sound));	
		buttonElement.innerHTML = sound.description.replace(/-/g, ' ');
		buttonElement.className = ButtonClass(sound);
		return buttonElement;
	}

	class BoardSound {
		constructor(sound) {
			this.sound = sound;
			this.audio = MakeAudioElement(sound);
			this.button = MakeButtonElement(sound);

			this.audio.onended = () => {			
				this.button.className = ButtonClass(sound);
			};

			this.button.onclick = () => {
					
				if (this.audio.paused) {
					playAudio(this.sound, this.audio, this.button);
				}
				else {
					stopAudio(this.sound, this.audio, this.button);
				}	
			};
		}

		AppendTo(control) {
			control.appendChild(this.button);
		}

		Stop() {
			stopAudio(this.sound, this.audio, this.button);
		}
	}

	class SoundsRepository {
		constructor(sounds) {
			this.data = {};

			sounds.forEach( sound => {
				var boardSound = new BoardSound(sound);
				this.data[sound.resource] = boardSound;			
			});
		}

		OnSound(soundId, f) {
			if (this.data[soundId] != null) {				
				f(this.data[soundId]);
			}		
		}

		StopAll() {
			for (var i in this.data) {
				this.data[i].Stop();
			}
		}
	}	

	class Board {
		constructor(control, repo) {
			this.control = control;
			this.soundsRepository = repo;
	
			this.Clear();
		}
		
		Add(sounds) {
			sounds.forEach(sound => {
				this.soundsRepository.OnSound(sound.resource, (boardSound) => {
					boardSound.AppendTo(this.control);
				});
			});		
		}

		Replace(sounds) {
			this.Clear();
			this.Add(sounds);
		}

		Clear() {
			while (this.control.firstChild) {
    			this.control.removeChild(this.control.firstChild);
			}
		}
	}

	function createMainBoard() {

		MainSounds = [		
			// crux
			new Sound("crux/aggiusta-il-mic.mp3", "aggiusta il microfono", ["crux", "microfono"]),
			new Sound("crux/amica-mia.mp3", "amica mia", ["crux"]),
			new Sound("crux/andiamo-con-ordine.mp3", "andiamo con ordine", ["crux"]),
			new Sound("crux/appassionato-di-odori.mp3", "appassionato di odori", ["crux"]),
			new Sound("crux/arrivederci-grazie.mp3", "arrivederci, grazie", ["crux"]),
			new Sound("crux/beh-amico-mio.mp3", "beh amico mio", ["crux"]),
			new Sound("crux/breaking-news.mp3", "breaking news", ["crux"]),
			new Sound("crux/che-testa-di-cazzo.mp3", "che testa di cazzo", ["crux"]),
			new Sound("crux/chi-sei.mp3", "chi sei?", ["crux"]),
			new Sound("crux/ciao-ciao.mp3", "ciao ciao", ["crux"]),
			new Sound("crux/come-ti-chiami.mp3", "come ti chiami?", ["crux"]),
			new Sound("crux/fermi-tutti.mp3", "fermi tutti", ["crux"]),	
			new Sound("crux/fermi-tutti-x2.mp3", "fermi tutti (x2)", ["crux"]),
			new Sound("crux/giu-questo-infame.mp3", "giù questo infame", ["crux"]),
			new Sound("crux/glory-hole.mp3", "glory hole", ["crux"]),
			new Sound("crux/hanno-ridato-il-telefono-al-demone.mp3", "hanno ridato il telefono al demone", ["crux"]),
			new Sound("crux/italiani.mp3", "italiani", ["crux"]),
			new Sound("crux/la-cosa-sessuale-più-incredibile.mp3", "la cosa sessuale più incredibile", ["crux"]),
			new Sound("crux/lei-non-sa-squirting.mp3", "lei non sa cos'è lo squirting?", ["crux"]),
			new Sound("crux/ma-sti-cazzi.mp3", "ma sti cazzi", ["crux"]),
			new Sound("crux/mai-piaciuta-la-patata.mp3", "mai piaciuta la patata?", ["crux"]),
			new Sound("crux/mhai-rotto-i-coglioni-ciao.mp3", "m'hai rotto i coglioni ciao", ["crux"]),
			new Sound("crux/monografia-sullo-squirting.mp3", "monografia sullo squirting", ["crux"]),
			new Sound("crux/non-me-ne-frega-niente.mp3", "non me ne frega niente", ["crux"]),
			new Sound("crux/non-sento-imbecille.mp3", "non sento, imbecille", ["crux"]),
			new Sound("crux/parentesi-inutili.mp3", "parentesi inutili", ["crux"]),
			new Sound("crux/per-caso-tu-squirti.mp3", "per caso tu squirti?", ["crux"]),
			new Sound("crux/perché-non-chiami-bene.mp3", "perchè non chiami bene?", ["crux"]),
			new Sound("crux/puttanata.mp3", "puttanata", ["crux"]),		
			new Sound("crux/qualcosa-di-grave.mp3", "qualcosa di grave", ["crux"]),
			new Sound("crux/questo-è-buono.mp3", "questo è buono", ["crux"]),
			new Sound("crux/se-non-lhai-capito.mp3", "se non l'hai capito", ["crux"]),
			new Sound("crux/signora-aurora.mp3", "signora aurora lei squirta?", ["crux"]),
			new Sound("crux/sono-cruciani.mp3", "sono cruciani", ["crux"]),
			new Sound("crux/sono-un-puttaniere.mp3", "sono un puttaniere", ["crux"]),
			new Sound("crux/spiegami-bene.mp3", "spiegami bene", ["crux"]),
			new Sound("crux/stai-zitto-nattimo.mp3", "stai zitto n'attimo", ["crux"]),
			new Sound("crux/togli-il-vivavoce.mp3", "togli il vivavoce", ["crux"]),
			new Sound("crux/top-assoluto.mp3", "top assoluto", ["crux"]),
			new Sound("crux/vado-ai-pazzi.mp3", "vado ai pazzi", ["crux"]),
			new Sound("crux/via-via.mp3", "via via", ["crux"]),

			// extras
			new Sound("crux/EXTRA-il-signor-giancarlo.mp3", "(extra) il signor giancarlo", ["extra"]),
			new Sound("crux/EXTRA-fede-figura-di-merda.mp3", "(extra) che figura di merda", ["extra"]),

			// jingles
			new Sound("jingle/a-tutto-foho.mp3", "a tutto foho", ["jingle"]),
			new Sound("jingle/amor.mp3", "amor", ["jingle", "pappalardo"]),
			new Sound("jingle/daje-brasiless.mp3", "daje brasiless", ["jingle", "brasile"]),
			new Sound("jingle/david-sta-andando-a-trans.mp3", "david sta andando a trans", ["jingle", "parenzo"]),
			new Sound("jingle/facciamo-un-delirio.mp3", "facciamo un delirio", ["jingle", "richard benson"]),
			new Sound("jingle/fede.mp3", "sfogo di fede", ["jingle"]),
			new Sound("jingle/feltri-non-me-ne-frega-niente.mp3", "feltri: non me ne frega niente", ["jingle", "feltri"]),
			new Sound("jingle/fenomeno.mp3", "fenomeno", ["jingle"]),
			new Sound("jingle/i-love-to-listen-to-la-zanzara.mp3", "I love to listen to la zanzara", ["jingle"]),
			new Sound("jingle/ibbrido-uccello-di-Hitchcock.mp3", "ibbrido uccello di Hitchcock", ["jingle"]),
			new Sound("jingle/la-mia-specialità-è-lo-squirting.mp3", "la mia specialità è lo squirting", ["jingle"]),
			new Sound("jingle/le-mutandine-di-valentina-nappi.mp3", "le mutandine di valentina nappi", ["jingle"]),
			new Sound("jingle/ma-è-una-roba-pazzesca.mp3", "ma è una roba pazzesca", ["jingle"]),
			new Sound("jingle/mio-nipote.mp3", "mio nipote", ["jingle"]),
			new Sound("jingle/pamplona.mp3", "pamplona", ["jingle"]),
			new Sound("jingle/parenzo.mp3", "parenzo", ["jingle", "parenzo"]),
			new Sound("jingle/parenzo-mio-maestro.mp3", "parenzo mio maestro", ["jingle", "parenzo"]),
			new Sound("jingle/sgarbi-vs-mughini.mp3", "sgarbi vs mughini", ["jingle", "sgarbi"]),
			new Sound("jingle/si-chiavano-tutto.mp3", "si chiavano tutto", ["jingle", "conte dolfin"]),
			new Sound("jingle/six-one.mp3", "six one", ["jingle"]),
			new Sound("jingle/soldi-feat-brasiliano.mp3", "soldi - ft. brasiliano", ["jingle", "brasile"]),
			new Sound("jingle/tefaf.mp3", "tefaf", ["jingle"]),
			new Sound("jingle/trasmissione-della-minchia.mp3", "trasmissione della minchia", ["jingle"]),
			new Sound("jingle/tu-le-offendi.mp3", "tu le offendi", ["jingle", "sgarbi"])
		];		

		repo = new SoundsRepository(MainSounds);
		board = new Board(document.getElementById("crux"), repo);
		
		CreateAllSoundsBoard();
	}

	function CreateJinglesBoard() {
		var jingles = MainSounds.filter( (sound) => {
			return sound.tags.includes("jingle");
		});

		board.Replace(jingles);
	}

	function CreateAllSoundsBoard() {
		board.Replace(MainSounds);
	}

	function ButtonSizeClicked() {				
		var sizeBtn = document.getElementById("btn-font");
		var turnBig = sizeBtn.innerHTML == "Grande";
		var sizeProp = turnBig ? "xx-large" : "";
		sizeBtn.innerHTML = turnBig ? "Piccolo" : "Grande";

		var buttons = document.getElementsByTagName("button");				
		for (var i=0; i<buttons.length; i++) {
			buttons[i].style.fontSize = sizeProp;		
		}
		
		sizeBtn.dataset.flag = false;
	}
</script>

<h2>Crux Soundboard</h2></head>
<br/>

<div id="crux-header" class="grid-header">
<button class="btnStop" id="btn-stop" onclick="repo.StopAll()">Stop</button>
<button class="btnAll" id="btn-font" onclick="ButtonSizeClicked()">Grande</button>
<button class="btnAll" id="btn-all" onclick="CreateAllSoundsBoard()">ALL</button>
<button class="btnAll" id="btn-jingles" onclick="CreateJinglesBoard()">Jingles</button>
<button class="btnAll" id="btn-custom" enabled="false">Custom</button>
<br/>
</div>

<div id="crux" class="grid-container">
</div>

</body>
</html>
